<script type="text/javascript">
  RED.nodes.registerType('ODBC CONFIG',{
    category: 'config',
    defaults: {
      connectionString: {value:"", required:true},
      name: {value:""},
      initialsize: {value:5},
      incrementsize: {value:5},
      maxsize: {value:15},
    },
    credentials: {
            username: {type:"text"},
            password: {type:"password"}
        },
    label: function() {
      return this.name || 'ODBC CONFIG';
    }
  });
</script>

<script type="text/html" data-template-name="ODBC CONFIG">

  <div class="form-row">
    <label for="node-config-input-name"><i class="fa fa-tag"></i> Connection String</label>
    <input type="text" id="node-config-input-name">
  </div>

  <div class="form-row">
    <label for="node-config-input-connectionString"><i class="icon-bookmark"></i>Connection String</label>
    <input type="text" id="node-config-input-connectionString" placeholder="DSN=...;">
  </div>

  <div class="form-row">
    <label for="node-config-input-username"><i class="fa fa-user"></i> Username</label>
    <input type="text" id="node-config-input-username">

  </div>
  <div class="form-row">
      <label for="node-config-input-password"><i class="fa fa-lock"></i> Password</label>
      <input type="password" id="node-config-input-password">
  </div>

  <div class="form-row">
    <label for="node-config-input-initialsize"><i class="icon-bookmark"></i>Initial Size</label>
    <input type="number" id="node-config-input-initialsize" placeholder="5">
  </div>

  <div class="form-row">
    <label for="node-config-input-incrementsize"><i class="icon-bookmark"></i>Increment Size</label>
    <input type="number" id="node-config-input-incrementsize" placeholder="5">
  </div>

  <div class="form-row">
    <label for="node-config-input-maxsize"><i class="icon-bookmark"></i>Max Size</label>
    <input type="number" id="node-config-input-maxsize" placeholder="15">
  </div>

  <div class="form-row">
    <label for="node-config-input-maxsize"><i class="icon-bookmark"></i>Shrink Pool</label>
    <button type="button" class="red-ui-button">On</button>
  </div>

  <div class="form-row">
    <label for="node-config-input-connectiontimeout"><i class="icon-bookmark"></i>Connection Timeout (sec)</label>
    <input type="number" id="node-config-input-connectiontimeout" placeholder="10">
  </div>

  <div class="form-row">
    <label for="node-config-input-logintimeout"><i class="icon-bookmark"></i>Login Timeout (sec)</label>
    <input type="number" id="node-config-input-logintimeout" placeholder="10">
  </div>
</script>

<script type="text/javascript">
  RED.nodes.registerType('odbcmj',{
  category: 'storage',
  color: '#8f34ad',
  defaults: {
      name: {value:""},
      connection: {type:"ODBC CONFIG", required:true},
      query: {value: ""},
      parameters: {value: ""},
      outField: {value:"payload"}
  },
  inputs:1,
  outputs:1,
  icon: "db.png",
  label: function() {
      return this.name||"odbcmj";
  },
  oneditprepare: function() {
    this.editor = RED.editor.createEditor({
      id: 'node-input-query-editor',
      mode: 'ace/mode/text',
      value: this.query
    });
  },
  oneditsave: function() {
    this.query = this.editor.getValue();
    this.editor.destroy();
    delete this.editor;
  },
  oneditcancel: function() {
    this.editor.destroy();
    delete this.editor;
  }
});
</script>

<script type="text/html" data-template-name="odbcmj">
  <div class="form-row">
    <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
    <input type="text" id="node-input-name">
  </div>
  <div class="form-row">
      <label for="node-input-connection"><i class="fa fa-cog"></i> Connection</label>
      <input type="text" id="node-input-connection">
  </div>
  <div class="form-row node-text-editor-row">
    <label for="node-input-query" style="width: 100% !important;"><i class="fa fa-search"></i> Query</label>
    <div style="height: 250px;" class="node-text-editor" id="node-input-query-editor" ></div>
  </div>
  <div class="form-row">
    <label for="node-input-parameters"><i class="fa fa-question"></i> Parameters</label>
    <input type="text" id="node-input-parameters" placeholder="[\"Value\", 123, ...]">
  </div>
  <div class="form-row">
      <label for="node-input-outField"><i class="fa fa-edit"></i> Result to</label>
      msg.<input type="text" id="node-input-outField" placeholder="payload" style="width: 64%;">
  </div>
</script>

<script type="text/html" data-help-name="odbcmj">
  <p>Node for running ODBC queries.</p>
  <h3>Inputs</h3>
    <dl class="message-properties">
      <dt>payload
        <span class="property-type">string | object</span>
      </dt>
      <dd>
        <p>A valid JSON string or JavaScript object that can contain "query" and/or "parameter" properties.
      </dd>
    </dl>
  <h3>Outputs</h3>
      <dl class="message-properties">
      <dt>payload
        <span class="property-type">object</span>
      </dt>
      <dd>
        An odbc result object (see the <a href=https://www.npmjs.com/package/odbc>odbc package docs</a>)
      </dd>
    </dl>
   <h3>Details</h3>
</script>
